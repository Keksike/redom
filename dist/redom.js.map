{"version":3,"file":"redom.js","sources":["../src/create-element.js","../src/mount.js","../src/setstyle.js","../src/setattr.js","../src/text.js","../src/util.js","../src/html.js","../src/setchildren.js","../src/list.js","../src/router.js","../src/svg.js"],"sourcesContent":["const HASH = '#'.charCodeAt(0);\nconst DOT = '.'.charCodeAt(0);\n\nexport function createElement (query, ns) {\n  let tag;\n  let id;\n  let className;\n\n  let mode = 0;\n  let start = 0;\n\n  for (let i = 0; i <= query.length; i++) {\n    const char = query.charCodeAt(i);\n\n    if (char === HASH || char === DOT || !char) {\n      if (mode === 0) {\n        if (i === 0) {\n          tag = 'div';\n        } else if (!char) {\n          tag = query;\n        } else {\n          tag = query.substring(start, i);\n        }\n      } else {\n        const slice = query.substring(start, i);\n\n        if (mode === 1) {\n          id = slice;\n        } else if (className) {\n          className += ' ' + slice;\n        } else {\n          className = slice;\n        }\n      }\n\n      start = i + 1;\n\n      if (char === HASH) {\n        mode = 1;\n      } else {\n        mode = 2;\n      }\n    }\n  }\n\n  const element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    if (ns) {\n      element.setAttribute('class', className);\n    } else {\n      element.className = className;\n    }\n  }\n\n  return element;\n}\n","import { getEl } from './util';\n\nconst hookNames = ['onmount', 'onunmount'];\n\n/**\n * Mount elements and components. If you define\n * the third parameter, it works like insertBefore\n * and otherwise it's like appendChild.\n *\n * Mount will trigger the onmount lifecycle event\n * the first time you mount a child. If you mount\n * the same child again to the same parent, onremount\n * gets called. If you mount it to another place,\n * onunmount and onmount get called. Read more about\n * lifecycle events here.\n * https://redom.js.org/documentation/#mount\n * @param {Element | Object} parent\n * @param {Element | Object} child\n * @param {Element | Object} [before]\n */\nexport function mount (parent, child, before) {\n  const parentEl = getEl(parent);\n  let childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n\n  const wasMounted = childEl.__redom_mounted;\n  const oldParent = childEl.parentNode;\n\n  if (wasMounted && (oldParent !== parentEl)) {\n    doUnmount(child, childEl, oldParent);\n  }\n\n  if (before != null) {\n    parentEl.insertBefore(childEl, getEl(before));\n  } else {\n    parentEl.appendChild(childEl);\n  }\n\n  doMount(child, childEl, parentEl, oldParent);\n\n  return child;\n}\n\n/**\n * When you need to remove elements/components.\n * https://redom.js.org/documentation/#unmount\n * @param {Element | Object} parent\n * @param {Element | Object} child\n */\nexport function unmount (parent, child) {\n  const parentEl = getEl(parent);\n  const childEl = getEl(child);\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  doUnmount(child, childEl, parentEl);\n\n  parentEl.removeChild(childEl);\n\n  return child;\n}\n\nfunction doMount (child, childEl, parentEl, oldParent) {\n  const hooks = childEl.__redom_lifecycle || (childEl.__redom_lifecycle = {});\n  const remount = (parentEl === oldParent);\n  let hooksFound = false;\n\n  for (let i = 0; i < hookNames.length; i++) {\n    const hookName = hookNames[i];\n\n    if (!remount && (child !== childEl) && (hookName in child)) {\n      hooks[hookName] = (hooks[hookName] || 0) + 1;\n    }\n    if (hooks[hookName]) {\n      hooksFound = true;\n    }\n  }\n\n  if (!hooksFound) {\n    childEl.__redom_mounted = true;\n    return;\n  }\n\n  let traverse = parentEl;\n  let triggered = false;\n\n  if (remount || (!triggered && (traverse && traverse.__redom_mounted))) {\n    trigger(childEl, remount ? 'onremount' : 'onmount');\n    triggered = true;\n  }\n\n  if (remount) {\n    return;\n  }\n\n  while (traverse) {\n    const parent = traverse.parentNode;\n    const parentHooks = traverse.__redom_lifecycle || (traverse.__redom_lifecycle = {});\n\n    for (const hook in hooks) {\n      parentHooks[hook] = (parentHooks[hook] || 0) + hooks[hook];\n    }\n\n    if (!triggered && (traverse === document || (parent && parent.__redom_mounted))) {\n      trigger(traverse, remount ? 'onremount' : 'onmount');\n      triggered = true;\n    }\n\n    traverse = parent;\n  }\n}\n\nfunction doUnmount (child, childEl, parentEl) {\n  const hooks = childEl.__redom_lifecycle;\n\n  if (!hooks) {\n    childEl.__redom_mounted = false;\n    return;\n  }\n\n  let traverse = parentEl;\n\n  if (childEl.__redom_mounted) {\n    trigger(childEl, 'onunmount');\n  }\n\n  while (traverse) {\n    const parentHooks = traverse.__redom_lifecycle || (traverse.__redom_lifecycle = {});\n    let hooksFound = false;\n\n    for (const hook in hooks) {\n      if (parentHooks[hook]) {\n        parentHooks[hook] -= hooks[hook];\n      }\n      if (parentHooks[hook]) {\n        hooksFound = true;\n      }\n    }\n\n    if (!hooksFound) {\n      traverse.__redom_lifecycle = null;\n    }\n\n    traverse = traverse.parentNode;\n  }\n}\n\nfunction trigger (el, eventName) {\n  if (eventName === 'onmount') {\n    el.__redom_mounted = true;\n  } else if (eventName === 'onunmount') {\n    el.__redom_mounted = false;\n  }\n\n  const hooks = el.__redom_lifecycle;\n\n  if (!hooks) {\n    return;\n  }\n\n  const view = el.__redom_view;\n  let hookCount = 0;\n\n  view && view[eventName] && view[eventName]();\n\n  for (const hook in hooks) {\n    if (hook) {\n      hookCount++;\n    }\n  }\n\n  if (hookCount) {\n    let traverse = el.firstChild;\n\n    while (traverse) {\n      const next = traverse.nextSibling;\n\n      trigger(traverse, eventName);\n\n      traverse = next;\n    }\n  }\n}\n","import { isString, getEl } from './util';\n\n/**\n * Easier way to update style attribute.\n * @param {Element | Object} view\n * @param {String | Object} arg1\n * @param {*} [arg2]\n */\nexport function setStyle (view, arg1, arg2) {\n  const el = getEl(view);\n\n  if (arg2 !== undefined) {\n    el.style[arg1] = arg2;\n  } else if (isString(arg1)) {\n    el.setAttribute('style', arg1);\n  } else {\n    for (const key in arg1) {\n      setStyle(el, key, arg1[key]);\n    }\n  }\n}\n","import { setStyle } from './setstyle';\nimport { isFunction, getEl } from './util';\n\n/**\n * A helper for updating attributes and properties.\n * Will auto-detect attributes and properties.\n * @param {Element | Object} view\n * @param {String | Object} arg1\n * @param {*} [arg2]\n */\nexport function setAttr (view, arg1, arg2) {\n  const el = getEl(view);\n  let isSVG = el instanceof window.SVGElement;\n\n  if (arg2 !== undefined) {\n    if (arg1 === 'style') {\n      setStyle(el, arg2);\n    } else if (isSVG && isFunction(arg2)) {\n      el[arg1] = arg2;\n    } else if (!isSVG && (arg1 in el || isFunction(arg2))) {\n      el[arg1] = arg2;\n    } else {\n      el.setAttribute(arg1, arg2);\n    }\n  } else {\n    for (const key in arg1) {\n      setAttr(el, key, arg1[key]);\n    }\n  }\n}\n","/**\n * Create a text node (if you need a reference to the node).\n * @return {Text}\n * @param {*} str\n */\nexport function text (str) {\n  return document.createTextNode(str);\n}\n","import { html } from './html';\nimport { mount } from './mount';\nimport { setAttr } from './setattr';\nimport { text } from './text';\n\nexport function parseArguments (element, args) {\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n\n    if (arg !== 0 && !arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (isString(arg) || isNumber(arg)) {\n      element.appendChild(text(arg));\n    } else if (isNode(getEl(arg))) {\n      mount(element, arg);\n    } else if (arg.length) {\n      parseArguments(element, arg);\n    } else if (typeof arg === 'object') {\n      setAttr(element, arg);\n    }\n  }\n}\n\nexport const ensureEl = parent => isString(parent) ? html(parent) : getEl(parent);\nexport const getEl = parent => (parent.nodeType && parent) || (!parent.el && parent) || getEl(parent.el);\n\nexport const isString = a => typeof a === 'string';\nexport const isNumber = a => typeof a === 'number';\nexport const isFunction = a => typeof a === 'function';\n\nexport const isNode = a => a && a.nodeType;\nexport const isList = a => a && a.__redom_list;\n","import { createElement } from './create-element';\nimport { parseArguments, isString, isNode } from './util';\n\nconst htmlCache = {};\n\nconst memoizeHTML = query => htmlCache[query] || (htmlCache[query] = createElement(query));\n\n/**\n * Helper for document.createElement with couple of differences.\n *\n * The basic idea is to simply create elements with el and\n * mount them with mount, almost like you would do with\n * plain JavaScript.\n * https://redom.js.org/documentation/#elements\n * @return {Element}\n * @param {String | Element} query - Query (tagname#ids.classes)\n * @param {*} [args]\n */\nexport function html (query, ...args) {\n  let element;\n\n  if (isString(query)) {\n    element = memoizeHTML(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n}\n\n/**\n * @return {html}\n * @param {String|Element} query - Query (tagname#ids.classes)\n */\nfunction extend (query) {\n  const clone = memoizeHTML(query);\n\n  return html.bind(this, clone);\n}\n\nhtml.extend = extend;\n\nexport const el = html;\n","import { mount, unmount } from './mount';\nimport { getEl } from './util';\n\n/**\n * RE:DOM uses setChildren(parent, children) under\n * the hood for lists. When you call setChildren,\n * RE:DOM will add/reorder/remove elements/components\n * automatically by reference.\n * @param {Element | Object} parent\n * @param {Array | Element | Object} children\n */\nexport function setChildren (parent, children) {\n  if (children.length === undefined) {\n    return setChildren(parent, [children]);\n  }\n\n  const parentEl = getEl(parent);\n  let traverse = parentEl.firstChild;\n\n  for (let i = 0; i < children.length; i++) {\n    const child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    let childEl = getEl(child);\n\n    if (childEl === traverse) {\n      traverse = traverse.nextSibling;\n      continue;\n    }\n\n    mount(parent, child, traverse);\n  }\n\n  while (traverse) {\n    const next = traverse.nextSibling;\n\n    unmount(parent, traverse);\n\n    traverse = next;\n  }\n}\n","import { setChildren } from './setchildren';\nimport { isFunction, ensureEl } from './util';\nimport { unmount } from './mount';\n\nconst propKey = key => item => item[key];\n\n/**\n * When you have dynamic data, it's not that easy to manually\n * keep the elements and the data in sync. That's when the\n * list helper comes to rescue.\n * https://redom.js.org/documentation/#lists\n * @return {List}\n * @param {Element | Object} parent\n * @param {function} View\n * @param {String | function} [key]\n * @param {*} [initData]\n */\nexport function list (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\n/**\n * When you have dynamic data, it's not that easy to manually\n * keep the elements and the data in sync. That's when the\n * list helper comes to rescue.\n * https://redom.js.org/documentation/#lists\n * @class List\n */\nexport class List {\n  /**\n   * Create a List\n   * @param {Element | Object} parent\n   * @param {function} View\n   * @param {String | function} [key]\n   * @param {*} [initData]\n   */\n  constructor (parent, View, key, initData) {\n    this.__redom_list = true;\n    this.View = View;\n    this.initData = initData;\n    this.views = [];\n    this.el = ensureEl(parent);\n\n    if (key != null) {\n      this.lookup = {};\n      this.key = isFunction(key) ? key : propKey(key);\n    }\n  }\n  /**\n   * Update the list\n   * @param {Array} data - Update list with data\n   */\n  update (data = []) {\n    const View = this.View;\n    const key = this.key;\n    const keySet = key != null;\n    const initData = this.initData;\n    const newViews = new Array(data.length);\n    const oldViews = this.views;\n    const newLookup = key && {};\n    const oldLookup = key && this.lookup;\n\n    for (let i = 0; i < data.length; i++) {\n      const item = data[i];\n      let view;\n\n      if (keySet) {\n        const id = key(item);\n        view = newViews[i] = oldLookup[id] || new View(initData, item, i, data);\n        newLookup[id] = view;\n        view.__id = id;\n      } else {\n        view = newViews[i] = oldViews[i] || new View(initData, item, i, data);\n      }\n      let el = view.el;\n      if (el.__redom_list) {\n        el = el.el;\n      }\n      el.__redom_view = view;\n      view.update && view.update(item, i, data);\n    }\n\n    if (keySet) {\n      for (let i = 0; i < oldViews.length; i++) {\n        const id = oldViews[i].__id;\n\n        if (!(id in newLookup)) {\n          unmount(this, oldLookup[id]);\n        }\n      }\n    }\n\n    setChildren(this, newViews);\n\n    if (keySet) {\n      this.lookup = newLookup;\n    }\n    this.views = newViews;\n  }\n}\n\n/**\n *\n * @return {List}\n * @param {Element | Object} parent\n * @param {function} View\n * @param {String | function} [key]\n * @param {*} [initData]\n */\nfunction extend (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n}\n\nlist.extend = List.extend = extend;\n","import { ensureEl } from './util';\nimport { setChildren } from './setchildren';\n\nexport function router (parent, Views, initData) {\n  return new Router(parent, Views, initData);\n}\n\n/**\n * Router is a component router, which will\n * create/update/remove components based on\n * the current route.\n * https://redom.js.org/documentation/#router\n * @class Router\n */\nexport class Router {\n  /**\n   * @param {Element | Object} parent\n   * @param {Object} Views\n   * @param {*} [initData]\n   */\n  constructor (parent, Views, initData) {\n    this.el = ensureEl(parent);\n    this.Views = Views;\n    this.initData = initData;\n  }\n  /**\n   *\n   * @param {String} route\n   * @param {*} [data]\n   */\n  update (route, data) {\n    if (route !== this.route) {\n      const Views = this.Views;\n      const View = Views[route];\n\n      this.view = View && new View(this.initData, data);\n      this.route = route;\n\n      setChildren(this.el, [ this.view ]);\n    }\n    this.view && this.view.update && this.view.update(data, route);\n  }\n}\n","import { createElement } from './create-element';\nimport { parseArguments, isString, isNode } from './util';\n\nconst SVG = 'http://www.w3.org/2000/svg';\n\nconst svgCache = {};\n\nconst memoizeSVG = query => svgCache[query] || (svgCache[query] = createElement(query, SVG));\n\n/**\n * el and html only create HTML elements. If you\n * want to create a SVG element, you must use `svg`.\n * @param {String | Element} query\n * @param {*} args\n */\nexport function svg (query, ...args) {\n  let element;\n\n  if (isString(query)) {\n    element = memoizeSVG(query).cloneNode(false);\n  } else if (isNode(query)) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  parseArguments(element, args);\n\n  return element;\n}\n\nsvg.extend = extend;\n\n/**\n * @return {svg}\n * @param {String | Element} query\n */\nfunction extend (query) {\n  const clone = memoizeSVG(query);\n\n  return svg.bind(this, clone);\n}\n"],"names":["const","HASH","DOT","createElement","query","ns","let","tag","id","className","mode","start","i","char","slice","element","hookNames","mount","parent","child","before","parentEl","getEl","childEl","wasMounted","oldParent","doUnmount","doMount","unmount","hooks","remount","hooksFound","hookName","traverse","triggered","trigger","parentHooks","hook","el","eventName","view","hookCount","next","setStyle","arg1","arg2","isString","key","setAttr","isSVG","isFunction","text","str","parseArguments","args","arg","isNumber","isNode","ensureEl","html","a","htmlCache","memoizeHTML","extend","clone","setChildren","children","propKey","item","list","View","initData","List","data","keySet","newViews","oldViews","newLookup","oldLookup","this","router","Views","Router","route","SVG","svgCache","memoizeSVG","svg"],"mappings":"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"}