'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var HASH=35,DOT=46;function createElement(a,b){var c,d,e,f=0,g=0;for(var h=0;h<=a.length;h++){var i=a.charCodeAt(h);if(i===HASH||i===DOT||!i){if(f===0)h===0?(c='div'):i?(c=a.substring(g,h)):(c=a);else{var j=a.substring(g,h);f===1?(d=j):e?(e+=' '+j):(e=j)}g=h+1;i===HASH?(f=1):(f=2)}}var k=b?document.createElementNS(b,c):document.createElement(c);d&&(k.id=d);e&&(b?k.setAttribute('class',e):(k.className=e));return k}var hookNames=['onmount','onunmount'];function mount(a,b,c){var d=getEl(a),e=getEl(b);b===e&&e.__redom_view&&(b=e.__redom_view);b!==e&&(e.__redom_view=b);var f=e.__redom_mounted,g=e.parentNode;f&&g!==d&&doUnmount(b,e,g);c!=null?d.insertBefore(e,getEl(c)):d.appendChild(e);doMount(b,e,d,g);return b}function unmount(a,b){var c=getEl(a),d=getEl(b);b===d&&d.__redom_view&&(b=d.__redom_view);doUnmount(b,d,c);c.removeChild(d);return b}function doMount(a,b,c,d){var e=b.__redom_lifecycle||(b.__redom_lifecycle={}),f=c===d,g=!1;for(var h=0;h<hookNames.length;h++){var i=hookNames[h];!f&&a!==b&&i in a&&(e[i]=(e[i]||0)+1);e[i]&&(g=!0)}if(!g){b.__redom_mounted=!0;return}var j=c,k=!1;(f||!k&&(j&&j.__redom_mounted))&&(trigger(b,f?'onremount':'onmount'),k=!0);if(f){return}while(j){var l=j.parentNode,m=j.__redom_lifecycle||(j.__redom_lifecycle={});for(var n in e)m[n]=(m[n]||0)+e[n];!k&&(j===document||l&&l.__redom_mounted)&&(trigger(j,f?'onremount':'onmount'),k=!0);j=l}}function doUnmount(a,b,c){var d=b.__redom_lifecycle;if(!d){b.__redom_mounted=!1;return}var e=c;b.__redom_mounted&&trigger(b,'onunmount');while(e){var f=e.__redom_lifecycle||(e.__redom_lifecycle={}),g=!1;for(var h in d)f[h]&&(f[h]-=d[h]),f[h]&&(g=!0);g||(e.__redom_lifecycle=null);e=e.parentNode}}function trigger(a,b){b==='onmount'?(a.__redom_mounted=!0):b==='onunmount'&&(a.__redom_mounted=!1);var c=a.__redom_lifecycle;if(!c){return}var d=a.__redom_view,e=0;d&&d[b]&&d[b]();for(var f in c)f&&e++;if(e){var g=a.firstChild;while(g){var h=g.nextSibling;trigger(g,b);g=h}}}function setStyle(a,b,c){var d=getEl(a);if(c!==undefined)d.style[b]=c;else if(isString(b))d.setAttribute('style',b);else{for(var e in b)setStyle(d,e,b[e])}}function setAttr(a,b,c){var d=getEl(a),e=d instanceof window.SVGElement;if(c!==undefined)b==='style'?setStyle(d,c):e&&isFunction(c)?(d[b]=c):!e&&(b in d||isFunction(c))?(d[b]=c):d.setAttribute(b,c);else{for(var f in b)setAttr(d,f,b[f])}}var text=function(a){return document.createTextNode(a)};function parseArguments(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d!==0&&!d){continue}typeof d==='function'?d(a):isString(d)||isNumber(d)?a.appendChild(text(d)):isNode(getEl(d))?mount(a,d):d.length?parseArguments(a,d):typeof d==='object'&&setAttr(a,d)}}var ensureEl=function(a){return isString(a)?html(a):getEl(a)},getEl=function(a){return a.nodeType&&a||!a.el&&a||getEl(a.el)},isString=function(a){return typeof a==='string'},isNumber=function(a){return typeof a==='number'},isFunction=function(a){return typeof a==='function'},isNode=function(a){return a&&a.nodeType},htmlCache={},memoizeHTML=function(a){return htmlCache[a]||(htmlCache[a]=createElement(a))};function html(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];var d;if(isString(a))d=memoizeHTML(a).cloneNode(!1);else if(isNode(a))d=a.cloneNode(!1);else{throw new Error('At least one argument required')};parseArguments(d,b);return d}function extend(a){var b=memoizeHTML(a);return html.bind(this,b)}html.extend=extend;var el=html;function setChildren(a,b){if(b.length===undefined){return setChildren(a,[b])}var c=getEl(a),d=c.firstChild;for(var e=0;e<b.length;e++){var f=b[e];if(!f){continue}var g=getEl(f);if(g===d){d=d.nextSibling;continue}mount(a,f,d)}while(d){var h=d.nextSibling;unmount(a,d);d=h}}var propKey=function(a){return function(b){return b[a]}};function list(a,b,c,d){return new List(a,b,c,d)}function List(a,b,c,d){this.__redom_list=!0;this.View=b;this.initData=d;this.views=[];this.el=ensureEl(a);c!=null&&(this.lookup={},this.key=isFunction(c)?c:propKey(c))}function extend$1(a,b,c,d){return List.bind(List,a,b,c,d)}List.extend=extend$1;list.extend=List.extend;List.prototype.update=function(a){var b=this;a===void 0&&(a=[]);var c=this.View,d=this.key,e=d!=null,f=this.initData,g=new Array(a.length),h=this.views,i=d&&{},j=d&&this.lookup;for(var k=0;k<a.length;k++){var l=a[k],m=void 0;if(e){var n=d(l);m=g[k]=j[n]||new c(f,l,k,a);i[n]=m;m.__id=n}else m=g[k]=h[k]||new c(f,l,k,a);var o=m.el;o.__redom_list&&(o=o.el);o.__redom_view=m;m.update&&m.update(l,k,a)}if(e){for(var p=0;p<h.length;p++){var q=h[p].__id;(q in i)||unmount(b,j[q])}}setChildren(this,g);e&&(this.lookup=i);this.views=g};function router(a,b,c){return new Router(a,b,c)}var Router=function d(a,b,c){this.el=ensureEl(a);this.Views=b;this.initData=c};Router.prototype.update=function c(a,b){if(a!==this.route){var d=this.Views,e=d[a];this.view=e&&new e(this.initData,b);this.route=a;setChildren(this.el,[this.view])}this.view&&this.view.update&&this.view.update(b,a)};var SVG='http://www.w3.org/2000/svg',svgCache={},memoizeSVG=function(a){return svgCache[a]||(svgCache[a]=createElement(a,SVG))};function svg(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];var d;if(isString(a))d=memoizeSVG(a).cloneNode(!1);else if(isNode(a))d=a.cloneNode(!1);else{throw new Error('At least one argument required')};parseArguments(d,b);return d}svg.extend=function(a){var b=memoizeSVG(a);return svg.bind(this,b)};exports.html=html;exports.el=el;exports.list=list;exports.List=List;exports.mount=mount;exports.unmount=unmount;exports.router=router;exports.Router=Router;exports.setAttr=setAttr;exports.setStyle=setStyle;exports.setChildren=setChildren;exports.svg=svg;exports.text=text
